<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Cardápio - Cafeteria Conforto</title>
<style>
  * {
    box-sizing: border-box;
  }
  body {
    margin:0; padding:0; 
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #e9f0f7;
    color: #33475b;
    -webkit-font-smoothing: antialiased;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  header {
    background: #a7c7e7;
    color: #fff;
    padding: 1rem;
    text-align: center;
    font-weight: 700;
    font-size: 1.8rem;
    user-select: none;
    position: relative;
  }
  main {
    flex: 1;
    max-width: 400px;
    margin: 0 auto;
    padding: 1rem;
    width: 100%;
  }
  .product-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin-bottom: 1rem;
  }
  .product {
    display: flex;
    background: #d6e3f0;
    border-radius: 0.8rem;
    padding: 0.8rem;
    align-items: center;
    box-shadow: 0 2px 6px rgba(51, 71, 91, 0.1);
  }
  .product img {
    width: 64px;
    height: 64px;
    border-radius: 0.6rem;
    object-fit: cover;
    user-select: none;
  }
  .details {
    flex: 1;
    padding-left: 1rem;
  }
  .details h2 {
    margin: 0 0 0.3rem 0;
    font-weight: 600;
    font-size: 1.1rem;
  }
  .details p {
    margin: 0;
    font-size: 0.85rem;
    color: #527093;
  }
  .details .price {
    margin-top: 0.4rem;
    font-weight: 700;
    color: #2a4370;
  }
  .quantity-controls {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .qty-btn {
    background: #a7c7e7;
    border: none;
    color: #fff;
    font-size: 1.4rem;
    width: 32px;
    height: 32px;
    border-radius: 0.4rem;
    cursor: pointer;
    user-select: none;
    line-height: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    box-shadow: 0 2px 6px #7ea5d7;
    transition: background 0.3s ease;
  }
  .qty-btn:active {
    background: #6091da;
  }
  .qty-display {
    margin: 0.3rem 0;
    font-weight: 700;
    font-size: 1.1rem;
    width: 32px;
    text-align: center;
    color: #2a4370;
    user-select: none;
  }
  .order-summary {
    background: #cde0f7;
    padding: 1rem;
    border-radius: 0.8rem;
    box-shadow: 0 2px 8px rgba(42, 67, 112, 0.15);
  }
  .order-summary h3 {
    margin-top: 0;
    font-weight: 700;
    color: #2a4370;
    font-size: 1.2rem;
    user-select: none;
  }
  .order-items {
    margin: 0.6rem 0 0.6rem 0;
    max-height: 150px;
    overflow-y: auto;
    font-size: 0.95rem;
    color: #33475b;
  }
  .order-total {
    font-weight: 700;
    font-size: 1.1rem;
    color: #33475b;
    margin-bottom: 1rem;
    user-select: none;
  }
  #sendOrderBtn {
    width: 100%;
    padding: 0.8rem;
    background: #7aaaee;
    border: none;
    border-radius: 0.6rem;
    font-size: 1.2rem;
    color: white;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 4px 10px #5b8bcc;
    user-select: none;
    transition: background 0.3s ease;
  }
  #sendOrderBtn:disabled {
    background: #a7c7e7;
    cursor: not-allowed;
    box-shadow: none;
  }
  #sendOrderBtn:not(:disabled):hover {
    background: #5b8bcc;
  }
  /* Scrollbar for order items */
  .order-items::-webkit-scrollbar {
    width: 6px;
  }
  .order-items::-webkit-scrollbar-thumb {
    background: #7aaaee;
    border-radius: 3px;
  }
  /* Responsividade e ajustes menores */
  @media (max-width: 400px) {
    .product {
      flex-direction: column;
      align-items: flex-start;
    }
    .quantity-controls {
      flex-direction: row;
      margin-top: 0.5rem;
    }
    .qty-btn {
      width: 36px;
      height: 36px;
      font-size: 1.6rem;
    }
  }
</style>
</head>
<body>
<header>Cafeteria Conforto</header>
<main>
  <section id="cliente-area" aria-label="Área do cliente - Cardápio e pedido">
    <div class="product-list" id="productList" tabindex="0">
      <!-- Produtos carregados via JS -->
    </div>
    <section class="order-summary" aria-live="polite" aria-atomic="true" aria-label="Resumo do pedido do cliente">
      <h3>Resumo do Pedido</h3>
      <div class="order-items" id="orderItems">
        Nenhum item adicionado.
      </div>
      <div class="order-total" id="orderTotal">
        Total: R$ 0,00
      </div>
      <button id="sendOrderBtn" disabled>Enviar Pedido</button>
    </section>
  </section>
</main>
<script>
  const products = [
    { id: 'espresso', name: 'Café Espresso', description: 'Café espresso forte e encorpado', price: 4.50,
      img: 'https://images.unsplash.com/photo-1525714186800-19a0be419291?ixlib=rb-4.0.3&auto=format&fit=crop&w=64&q=80'},
    { id: 'cappuccino', name: 'Cappuccino', description: 'Espuma cremosa com toque de chocolate', price: 7.00,
      img: 'https://images.unsplash.com/photo-1511920170033-f8396924c348?ixlib=rb-4.0.3&auto=format&fit=crop&w=64&q=80'},
    { id: 'latte', name: 'Latte', description: 'Leite vaporizado com café suave', price: 6.00,
      img: 'https://images.unsplash.com/photo-1509042239860-f550ce710b93?ixlib=rb-4.0.3&auto=format&fit=crop&w=64&q=80'},
    { id: 'mocha', name: 'Mocha', description: 'Café com chocolate e chantilly', price: 7.50,
      img: 'https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?ixlib=rb-4.0.3&auto=format&fit=crop&w=64&q=80'},
    { id: 'cookie', name: 'Biscoito amanteigado', description: 'Biscoitos crocantes para acompanhar', price: 3.00,
      img: 'https://images.unsplash.com/photo-1505253210343-cdca418a61f5?ixlib=rb-4.0.3&auto=format&fit=crop&w=64&q=80'}
  ];

  const productListEl = document.getElementById('productList');
  const orderItemsEl = document.getElementById('orderItems');
  const orderTotalEl = document.getElementById('orderTotal');
  const sendOrderBtn = document.getElementById('sendOrderBtn');

  let order = {};

  function formatPrice(value) {
    return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
  }

  function renderProducts() {
    productListEl.innerHTML = '';
    products.forEach(product => {
      const productEl = document.createElement('div');
      productEl.className = 'product';
      productEl.setAttribute('data-id', product.id);
      productEl.innerHTML = `
        <img src="${product.img}" alt="${product.name}" loading="lazy" />
        <div class="details">
          <h2>${product.name}</h2>
          <p>${product.description}</p>
          <div class="price">${formatPrice(product.price)}</div>
        </div>
        <div class="quantity-controls" role="group" aria-label="Controle de quantidade para ${product.name}">
          <button class="qty-btn" aria-label="Diminuir quantidade" data-action="decrease">-</button>
          <div class="qty-display" aria-live="polite" aria-atomic="true">0</div>
          <button class="qty-btn" aria-label="Aumentar quantidade" data-action="increase">+</button>
        </div>
      `;
      productListEl.appendChild(productEl);
    });
  }

  function updateOrder(productId, delta) {
    const currentQty = order[productId] || 0;
    let newQty = currentQty + delta;
    if (newQty < 0) newQty = 0;
    order[productId] = newQty;
    if (newQty === 0) delete order[productId];
    renderOrder();
    updateQuantityDisplay(productId);
  }
  function updateQuantityDisplay(productId) {
    const productEl = productListEl.querySelector(`.product[data-id="${productId}"]`);
    if (!productEl) return;
    const qtyDisplay = productEl.querySelector('.qty-display');
    const qty = order[productId] || 0;
    qtyDisplay.textContent = qty.toString();
  }
  function renderOrder() {
    const keys = Object.keys(order);
    if (keys.length === 0) {
      orderItemsEl.textContent = 'Nenhum item adicionado.';
      orderTotalEl.textContent = 'Total: R$ 0,00';
      sendOrderBtn.disabled = true;
      return;
    }
    let summaryHTML = '';
    let total = 0;
    keys.forEach(id => {
      const product = products.find(p => p.id === id);
      const quantity = order[id];
      const price = product.price * quantity;
      total += price;
      summaryHTML += `<div>${quantity} x ${product.name} - ${formatPrice(price)}</div>`;
    });
    orderItemsEl.innerHTML = summaryHTML;
    orderTotalEl.textContent = `Total: ${formatPrice(total)}`;
    sendOrderBtn.disabled = false;
  }
  productListEl.addEventListener('click', (e) => {
    const btn = e.target.closest('.qty-btn');
    if (!btn) return;
    const action = btn.dataset.action;
    const productEl = btn.closest('.product');
    const productId = productEl.getAttribute('data-id');
    if (action === 'increase') {
      updateOrder(productId, +1);
    } else if (action === 'decrease') {
      updateOrder(productId, -1);
    }
  });

  // Função para gerar ID única para pedidos
  function generateOrderId() {
    return 'p' + Date.now().toString(36) + Math.random().toString(36).slice(2,5);
  }

  // Função para salvar pedido no localStorage
  function saveOrderPedido(orderObj) {
    const pedidos = getPedidos() || [];
    pedidos.push(orderObj);
    localStorage.setItem('cafeteria_pedidos', JSON.stringify(pedidos));
  }

  // Função para pegar os pedidos do localStorage
  function getPedidos() {
    const pedidosStr = localStorage.getItem('cafeteria_pedidos');
    if (!pedidosStr) return [];
    try {
      return JSON.parse(pedidosStr);
    } catch {
      return [];
    }
  }

  // Evento enviar pedido
  sendOrderBtn.addEventListener('click', () => {
    if (Object.keys(order).length === 0) return;

    const pedidoId = generateOrderId();
    const timestamp = Date.now();
    const pedidoProdutos = Object.entries(order).map(([prodId, qty]) => {
      return { productId: prodId, quantity: qty, done: false };
    });

    const novoPedido = {
      id: pedidoId,
      timestamp,
      produtos: pedidoProdutos
    };

    saveOrderPedido(novoPedido);

    // Limpar pedido atual
    order = {};
    renderOrder();
    products.forEach(p => updateQuantityDisplay(p.id));

    alert('Pedido enviado com sucesso! Por favor, aguarde no seu lugar.');
  });

  // Inicialização
  function init() {
    renderProducts();
    renderOrder();
  }
  init();
</script>
</body>
</html>

